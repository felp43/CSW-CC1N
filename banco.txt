select j.rodada, g.clube, g.atleta, g.minuto from gols g
	inner join jogos j on g.partida_id = j.id
	where j.rodada = 36 and j.mandante ilike '%Corinthians%' and j.visitante ilike '%Sao Paulo%'
	and data = '2016-10-11';


select j.vencedor, j.visitante, (j.mandante_placar, 'x' ,j.visitante_placar), j.arena, j.data
	from jogos j
	where j.data between '2024-01-01' and '2024-12-31' and j.vencedor = j.mandante and j.vencedor ilike '%Vasco%' and j.arena ilike '%Estádio São Januário%';
	

select e.clube, e.chutes, e.chutes_no_gol, j.data from estatisticas e
	inner join jogos j on e.partida_id = j.id
	where (j.rodada between 10 and 13 or j.rodada = 15) and e.clube = j.mandante and j.data between '2019-01-01' and '2019-12-31';


select g.atleta, g.clube, j.arena, j.data from gols g
	inner join jogos j on g.partida_id = j.id
	where j.data between '2020-01-01' and '2020-12-31';


SELECT c.atleta,c.clube, c.minuto, jm.tecnico_mandante as tecnico_mandante, jv.tecnico_visitante AS tecnico_visitante
	FROM cartoes c
	LEFT JOIN jogos jm ON c.partida_id = jm.id AND c.clube = jm.mandante
	LEFT JOIN jogos jv ON c.partida_id = jv.id AND c.clube = jv.visitante;


SELECT j.data, c.atleta,c.clube, c.minuto, j.tecnico_mandante as tecnico
	FROM cartoes c
	LEFT JOIN jogos j ON c.partida_id = j.id AND c.clube = j.mandante
	where extract (year from j.data) = '2018';


SELECT j.clube, SUM(g.total_gols) AS total_gols_marcados, SUM(e.chutes_no_gol) AS total_chutes_a_gol
	FROM ( SELECT DISTINCT mandante AS clube FROM jogos
			WHERE rodada = 5 UNION SELECT DISTINCT visitante AS clube FROM jogos
				WHERE rodada = 5) AS j
	LEFT JOIN ( SELECT clube, COUNT(*) AS total_gols FROM gols
					WHERE rodada = 5 GROUP BY clube) AS g
			ON j.clube = g.clube
	LEFT JOIN ( SELECT clube, SUM(chutes_no_gol) AS chutes_no_gol
				FROM estatisticas
					WHERE rodada = 5 GROUP BY clube) AS e
			ON j.clube = e.clube GROUP BY j.clube ORDER BY total_gols_marcados DESC;
